<div>
    <div style="margin-bottom: 1em">
        <span style="color: #878787; display: block" id="previous-week-date"></span>
        <span id="previous-week-name"></span>
    </div>
    <div style="font-size: 1.2em; margin-bottom: 1em">
        <span style="color: #878787; display: block" id="this-week-date"></span>
        <span id="this-week-name"></span>
    </div>
    <div style="margin-bottom: 1em">
        <span style="color: #878787; display: block" id="next-week-date"></span>
        <span id="next-week-name"></span>
    </div>
</div>
<script>
    var today = new Date();
    var year = new Date(today.getFullYear(), 0, 1);
    var week = Math.floor(((today - year) / 86400000) / 7) + 1;

    // This is a hack to not mess the checkins order when we change the amount
    // of working groups.
    // Increment this number by one when you realize that after adding
    // working groups the website checkins order messes.
    var magic_number = 1;

    // Add new working groups on the end of the list.
    // When adding/removing working groups adjust magic number to match the
    // current order we see on the page.
    var wgs = [
        "Async Foundations",
        "Diagnostics",
        "Rustc Dev Guide",
        "LLVM",
        "Meta",
        "MIR Optimizations",
        "Polonius",
        "Polymorphization",
        "RFC 2229",
        "RLS 2.0",
        "Self-Profile",
        "Traits"
    ];
    // For each working group, add a link to its rust-lang/team toml file,
    // in the same order as the `wgs` array above, so that the people using the schedule
    // can see the wg members to ping.
    var links = [
        "https://github.com/rust-lang/team/blob/master/teams/wg-async-foundations.toml",
        "https://github.com/rust-lang/team/blob/master/teams/wg-diagnostics.toml",
        "https://github.com/rust-lang/team/blob/master/teams/wg-rustc-dev-guide.toml",
        "https://github.com/rust-lang/team/blob/master/teams/wg-llvm.toml",
        "https://github.com/rust-lang/team/blob/master/teams/wg-meta.toml",
        "https://github.com/rust-lang/team/blob/master/teams/wg-mir-opt.toml",
        "https://github.com/rust-lang/team/blob/master/teams/wg-polonius.toml",
        "https://github.com/rust-lang/team/blob/master/teams/wg-polymorphization.toml",
        "https://github.com/rust-lang/team/blob/master/teams/wg-rfc-2229.toml",
        "https://github.com/rust-lang/team/blob/master/teams/wg-rls-2.toml",
        "https://github.com/rust-lang/team/blob/master/teams/wg-self-profile.toml",
        "https://github.com/rust-lang/team/blob/master/teams/wg-traits.toml"
    ];
    var count = wgs.length % 2 === 0 ? wgs.length : wgs.length + 1;

    function getDateFromWeek(week, year) {
        var day = (2 + (week - 1) * 7);
        return new Date(Date.UTC(year, 0, day));
    }

    function getDateString(date) {
        return date.toISOString().substring(0, 10);
    }

    function updateElementForWeek(week, element, name) {
        var index = (week + magic_number) * 2 % count;
        var names = [index, index + 1].map(i => wgs[i]);
        var tomls = [index, index + 1].map(i => links[i]);

        var message;
        if ((typeof names[1]) !== "undefined") {
            message = `<a href="${tomls[0]}" target="_blank">${names[0]}</a> and <a href="${tomls[1]}" target="_blank">${names[1]}</a>`;
        } else {
            message = `<a href="${tomls[0]}" target="_blank">${names[0]}</a>`;
        }

        document.getElementById(element + "-name").innerHTML = message;
        document.getElementById(element + "-date").innerHTML =
            name + ": " +
            getDateString(getDateFromWeek(week, today.getFullYear())) + " - " +
            getDateString(getDateFromWeek(week + 1, today.getFullYear()));
    }

    updateElementForWeek(week + 1, "next-week", "Next Week");
    updateElementForWeek(week, "this-week", "This Week");
    updateElementForWeek(week - 1, "previous-week", "Previous Week");
</script>
